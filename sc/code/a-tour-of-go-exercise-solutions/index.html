<!doctype html>
<html class="no-js" lang="sc">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Fancy">
    <meta name="description" content="Bilberry Premium Theme for Hugo.">
    <meta name="keywords" content="blog,personal,responsive,search,font awesome,pages,posts,multilingual,highlight.js,syntax highlighting,premium,shortcuts">
    <meta name="generator" content="Hugo 0.67.0" />
    <title> Golang 练习N则 | Fancy‘s Technology Blog</title>
    <meta name="description" content="Golang 练习N则 - Bilberry Premium Theme for Hugo.">
    <meta itemprop="name" content="Golang 练习N则">
    <meta itemprop="description" content="Golang 练习N则 - Bilberry Premium Theme for Hugo.">
    <meta property="og:title" content="Golang 练习N则">
    <meta property="og:description" content="Golang 练习N则 - Bilberry Premium Theme for Hugo.">
    <meta property="og:image" content="https://www.gravatar.com/avatar/3776f719d93bf9d357bf83b6e50e10d6?size=200">
    <meta property="og:url" content="https://bbyy.io/sc/code/a-tour-of-go-exercise-solutions/">
    <meta property="og:site_name" content="Fancy‘s Technology Blog">
    <meta property="og:type" content="article">

    
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#e2619c">
<meta name="msapplication-TileColor" content="#e2619c">
<meta name="theme-color" content="#e2619c">

    
    <link href="/sc/code/a-tour-of-go-exercise-solutions/" rel="alternate" type="application/rss+xml" title="Fancy‘s Technology Blog" />
    <link href="/sc/code/a-tour-of-go-exercise-solutions/" rel="feed" type="application/rss+xml" title="Fancy‘s Technology Blog" />
    

    

    <link rel="stylesheet" href="https://bbyy.io/theme.css">

    

    
    
    
</head>

<body class="bilberry-hugo-theme">

    
    <nav class="permanentTopNav sticky">

    <div class="container">
        <ul class="topnav">
            
            
            <li><a href="https://bbyy.io/sc/page/about-me/">关于本人</a></li>
            
            
            
            <li><a href="https://github.com/hallucigenia" target="_blank">Github</a></li>
            
            
        </ul>

        
        <div id="search-box" class="search">
            <i class="fas fa-search"></i>
            <input id="search" type="text" placeholder="">
        </div>
        
    </div>
</nav>


    
<header class="sticky">

    <div class="container">
        <div class="logo">
            <a id="siteBaseUrl" href="/sc" class="logo">
                
                <img src="https://www.gravatar.com/avatar/3776f719d93bf9d357bf83b6e50e10d6?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-tape"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a
                    href="/sc">Fancy‘s Technology Blog</a></h3>
            
            <span class="subtitle">Fancy的技术博客</span>
            
        </div>

        <div class="languages">
        
            
                <a href="https://bbyy.io/">tc</a>
            
        
            
                <a href="https://bbyy.io/sc/" class="active">sc</a>
            
        
            
                <a href="https://bbyy.io/en/">en</a>
            
        
        </div>
        

        
        <div class="toggler permanentTopNav">
            
                <i class="fa fa-bars" aria-hidden="true"></i>
            </div>
        </div>
</header>


    <div class="main container">
        
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://bbyy.io/sc/code/a-tour-of-go-exercise-solutions/">
    <i class="fas fa-fw fa-code"></i>
</a>

<article class="default article">
    
    <div class="featured-image">
        <a href="https://bbyy.io/sc/code/a-tour-of-go-exercise-solutions/">
            
                <img src="/sc/code/a-tour-of-go-exercise-solutions/featuredImage_hube8e9dd9e2adde6277b1430c4ad6fb74_31957_700x350_fill_q95_box_smart1.jpg" alt="">
            
        </a>
    </div>


    <div class="content">
    <h1 class="article-title"><a href="https://bbyy.io/sc/code/a-tour-of-go-exercise-solutions/">Golang 练习N则</a></h1>
    <div class="meta">
        
        
        <span class="date moment">2020-01-29</span>
        
        

        

        
        <span class="categories">
            
                
                <a href="https://bbyy.io/sc/categories/code/">Code</a>
                
            
        </span>
        

        
        <span class="author">
            
            <a href="https://bbyy.io/sc/author/fancy/">Fancy</a>
            
        </span>
        
    </div>

    
    <p>golang练手项目，一周每天做两个Golang练习，近期温习一下并适当做些注释</p>
<p>在主Python的时候，也要巩固提升自己的Go姿势水平，练习题目来自<a href="https://go-tour-zh-tw.appspot.com">A Tour of Go</a>，提供多语言，教程说实话比较经典了，闲的时候值得一看的Golang初中级进阶教程，比想象中的要闹心。干拉会很吃力，刚好查漏补缺，还是需要其他Golang基础的。</p>
<h2 id="練習循環和函式">練習：循環和函式</h2>
<p>作為練習函式和循環的簡單途徑，用牛頓法實現開方函式。</p>
<p>在這個例子中，牛頓法是通過選擇一個初始點 <em>z</em> 然後重複這一過程求 <code>Sqrt(x)</code> 的近似值：</p>
<p><img src="https://go-tour-zh-tw.appspot.com/content/img/newton.png" alt="img"></p>
<p>為了做到這個，只需要重複計算 10 次，並且觀察不同的值（1，2，3，……）是如何逐步逼近結果的。 然後，修改循環條件，使得當值停止改變（或改變非常小）的時候退出循環。觀察迭代次數是否變化。結果與 <a href="http://golang.org/pkg/math/#Sqrt">math.Sqrt</a> 接近嗎？</p>
<p>提示：定義並初始化一個浮點值，向其提供一個浮點語法或使用轉換：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">z</span> <span style="color:#f92672">:=</span> float64(<span style="color:#ae81ff">1</span>)
<span style="color:#a6e22e">z</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">1.0</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;math&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Sqrt</span>(<span style="color:#a6e22e">x</span> <span style="color:#66d9ef">float64</span>) <span style="color:#66d9ef">float64</span> {
    <span style="color:#a6e22e">z</span>, <span style="color:#a6e22e">k</span> <span style="color:#f92672">:=</span> float64(<span style="color:#ae81ff">1</span>), float64(<span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">k</span> &gt; <span style="color:#ae81ff">1e-15</span> {
        <span style="color:#a6e22e">d</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">z</span>
        <span style="color:#a6e22e">z</span> = <span style="color:#a6e22e">z</span> <span style="color:#f92672">-</span> (<span style="color:#a6e22e">z</span><span style="color:#f92672">*</span><span style="color:#a6e22e">z</span><span style="color:#f92672">-</span><span style="color:#a6e22e">x</span>)<span style="color:#f92672">/</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span><span style="color:#a6e22e">z</span>)
        <span style="color:#a6e22e">k</span> = <span style="color:#a6e22e">z</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">d</span>
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">k</span> &lt; <span style="color:#ae81ff">0</span> {
            <span style="color:#a6e22e">k</span> = <span style="color:#a6e22e">d</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">z</span>
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">z</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">Sqrt</span>(<span style="color:#ae81ff">2</span>))
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">math</span>.<span style="color:#a6e22e">Sqrt</span>(<span style="color:#ae81ff">2</span>))
}
</code></pre></div><h2 id="練習slice">練習：slice</h2>
<p>實現 <code>Pic</code> 。它返回一個 slice 的長度 <code>dy</code> ，和 slice 中每個元素的長度的 8 位無符號整數 <code>dx</code> 。當執行這個程式，它會將整數轉換為灰度（好吧，藍度）圖片進行展示。</p>
<p>圖片的實現已經完成。可能用到的函式包括 <code>&gt;x^y</code> ， <code>(x+y)/2</code> 和 <code>x*y</code> 。</p>
<p>（需要使用循環來分配 <code>[][]uint8</code> 中的每個 <code>[]uint8</code>。）</p>
<p>（使用 <code>uint8(intValue)</code> 在類型之間進行轉換。）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;code.google.com/p/go-tour/pic&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Pic</span>(<span style="color:#a6e22e">dx</span>, <span style="color:#a6e22e">dy</span> <span style="color:#66d9ef">int</span>) [][]<span style="color:#66d9ef">uint8</span> {
    <span style="color:#a6e22e">img</span> <span style="color:#f92672">:=</span> make([][]<span style="color:#66d9ef">uint8</span>, <span style="color:#a6e22e">dy</span>)
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">x</span> &lt; <span style="color:#a6e22e">dy</span>; <span style="color:#a6e22e">x</span><span style="color:#f92672">++</span> {
        <span style="color:#a6e22e">img</span>[<span style="color:#a6e22e">x</span>] = make([]<span style="color:#66d9ef">uint8</span>, <span style="color:#a6e22e">dx</span>)
        <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">y</span> &lt; <span style="color:#a6e22e">dx</span>; <span style="color:#a6e22e">y</span><span style="color:#f92672">++</span> {
            <span style="color:#a6e22e">img</span>[<span style="color:#a6e22e">x</span>][<span style="color:#a6e22e">y</span>] = uint8((<span style="color:#a6e22e">x</span> ^ <span style="color:#a6e22e">y</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">y</span>)
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">img</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">pic</span>.<span style="color:#a6e22e">Show</span>(<span style="color:#a6e22e">Pic</span>)
}
</code></pre></div><hr>
<h2 id="練習map">練習：map</h2>
<p>實現 <code>WordCount</code> 。它應當返回一個含有 <code>s</code> 中每個「詞」個數的 map。函式 <code>wc.Test</code> 針對這個函式執行一個測試用例，並顯示成功或者失敗。</p>
<p>你會發現 <a href="http://golang.org/pkg/strings/#Fields">strings.Fields</a> 很有幫助。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;code.google.com/p/go-tour/wc&#34;</span>
    <span style="color:#e6db74">&#34;strings&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">WordCount</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span> {
    <span style="color:#a6e22e">source</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span>)
  
  <span style="color:#75715e">// 將字符串分成單個word
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">words</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Fields</span>(<span style="color:#a6e22e">s</span>)
  
  <span style="color:#75715e">// 遍歷單詞，出現`s`則+1
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">word</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">words</span> {
        <span style="color:#a6e22e">source</span>[<span style="color:#a6e22e">word</span>]<span style="color:#f92672">++</span>
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">source</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">wc</span>.<span style="color:#a6e22e">Test</span>(<span style="color:#a6e22e">WordCount</span>)
}
</code></pre></div><h2 id="練習斐波納契閉包">練習：斐波納契閉包</h2>
<p>現在來通過函式做些有趣的事情。</p>
<p>實現一個 <code>fibonacci</code> 函式，返回一個函式（一個閉包）可以返回連續的斐波納契數。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#75715e">// fibonacci is a function that returns
</span><span style="color:#75715e">// a function that returns an int.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">fibonacci</span>() <span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">int</span> {
    <span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">int</span> {
        <span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span> = <span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">a</span><span style="color:#f92672">+</span><span style="color:#a6e22e">b</span>
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span>
    }
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">f</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fibonacci</span>()
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#ae81ff">10</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">f</span>())
    }
}
</code></pre></div><hr>
<h2 id="進階練習複數的立方跟">進階練習：複數的立方跟</h2>
<p>讓我們通過 <code>complex64</code> 和 <code>complex128</code> 來探索一下 Go 內建的複數。對於立方根，牛頓法需要大量循環：</p>
<p><img src="https://go-tour-zh-tw.appspot.com/content/img/newton3.png" alt="img"></p>
<p>找到 2 的立方根，確保算法能夠工作。在 <code>math/cmplx</code> 包中有 <a href="http://golang.org/pkg/math/cmplx/#Pow">Pow</a> 函式。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;math/cmplx&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Cbrt</span>(<span style="color:#a6e22e">x</span> <span style="color:#66d9ef">complex128</span>) <span style="color:#66d9ef">complex128</span> {
    <span style="color:#a6e22e">z</span> <span style="color:#f92672">:=</span> complex128(<span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#ae81ff">1000</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
        <span style="color:#a6e22e">z</span> = <span style="color:#a6e22e">z</span> <span style="color:#f92672">-</span> (<span style="color:#a6e22e">cmplx</span>.<span style="color:#a6e22e">Pow</span>(<span style="color:#a6e22e">z</span>, complex128(<span style="color:#ae81ff">3</span>))<span style="color:#f92672">-</span><span style="color:#a6e22e">x</span>)<span style="color:#f92672">/</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span><span style="color:#a6e22e">cmplx</span>.<span style="color:#a6e22e">Pow</span>(<span style="color:#a6e22e">z</span>, complex128(<span style="color:#ae81ff">2</span>)))
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">z</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">Cbrt</span>(<span style="color:#ae81ff">2</span>))
}
</code></pre></div><h2 id="練習錯誤">練習：錯誤</h2>
<p>​    從之前的練習中複製 <code>Sqrt</code> 函式，並修改使其返回 <code>error</code> 值。</p>
<p>​    <code>Sqrt</code> 接收到一個負數時，應當返回一個非 nil 的錯誤值。複數同樣也不被支持。</p>
<p>​    創建一個新類型</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ErrNegativeSqrt</span> <span style="color:#66d9ef">float64</span>
</code></pre></div><p>​    為其實現</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">ErrNegativeSqrt</span>) <span style="color:#a6e22e">Error</span>() <span style="color:#66d9ef">string</span>
</code></pre></div><p>​    使其成為一個 <code>error</code>， 該方法就可以讓 <code>ErrNegativeSqrt(-2).Error()</code> 返回 <code>&quot;cannot Sqrt negative number: -2&quot;</code>。</p>
<p>​    <strong>注意：</strong> 在 <code>Error</code> 方法內調用 <code>fmt.Print(e)</code> 將會讓程式陷入死循環。可以通過先轉換 <code>e</code> 來避免這個問題：<code>fmt.Print(float64(e))</code>。請思考這是為什麼呢？</p>
<p>​    修改 <code>Sqrt</code> 函式，使其接受一個負數時，返回 <code>ErrNegativeSqrt</code> 值。</p>
<h4 id="解答">解答：</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;math&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ErrNegativeSqrt</span> <span style="color:#66d9ef">float64</span>

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">ErrNegativeSqrt</span>) <span style="color:#a6e22e">Error</span>() <span style="color:#66d9ef">string</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;cannot Sqrt negative number: %v&#34;</span>, float64(<span style="color:#a6e22e">e</span>))
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Sqrt</span>(<span style="color:#a6e22e">x</span> <span style="color:#66d9ef">float64</span>) (<span style="color:#66d9ef">float64</span>, <span style="color:#66d9ef">error</span>) {
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">x</span> &lt; <span style="color:#ae81ff">0</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">ErrNegativeSqrt</span>(<span style="color:#a6e22e">x</span>)
    }
    <span style="color:#a6e22e">z</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2.0</span>
    <span style="color:#66d9ef">for</span> {
        <span style="color:#a6e22e">y</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">z</span> <span style="color:#f92672">-</span> (<span style="color:#a6e22e">z</span><span style="color:#f92672">*</span><span style="color:#a6e22e">z</span><span style="color:#f92672">-</span><span style="color:#a6e22e">x</span>)<span style="color:#f92672">/</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span><span style="color:#a6e22e">z</span>)
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">math</span>.<span style="color:#a6e22e">Abs</span>(<span style="color:#a6e22e">y</span><span style="color:#f92672">-</span><span style="color:#a6e22e">z</span>) &lt; <span style="color:#ae81ff">1e-9</span> {
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">y</span>, <span style="color:#66d9ef">nil</span>
        }
        <span style="color:#a6e22e">z</span> = <span style="color:#a6e22e">y</span>
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">z</span>, <span style="color:#66d9ef">nil</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">Sqrt</span>(<span style="color:#ae81ff">2</span>))
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">Sqrt</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>))
}
</code></pre></div><hr>
<h2 id="練習http-處理">練習：HTTP 處理</h2>
<p>​    實現下面的類型，並在其上定義 ServeHTTP 方法。在 web 服務器中註冊它們來處理指定的路徑。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">String</span> <span style="color:#66d9ef">string</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Struct</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Greeting</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Punct</span>    <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Who</span>      <span style="color:#66d9ef">string</span>
}
</code></pre></div><p>​    例如，可以使用如下方式註冊處理方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/string&#34;</span>, <span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;I&#39;m a frayed knot.&#34;</span>))
<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/struct&#34;</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Struct</span>{<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;:&#34;</span>, <span style="color:#e6db74">&#34;Gophers!&#34;</span>})
</code></pre></div><h4 id="解答-1">解答：</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">String</span> <span style="color:#66d9ef">string</span>

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">String</span>) <span style="color:#a6e22e">ServeHTTP</span>(
    <span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>,
    <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprint</span>(<span style="color:#a6e22e">w</span>, <span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#a6e22e">s</span>)
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Struct</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Greeting</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Punct</span>    <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Who</span>      <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">Struct</span>) <span style="color:#a6e22e">ServeHTTP</span>(
    <span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>,
    <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprint</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Greeting</span><span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Punct</span><span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Who</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/string&#34;</span>, <span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;I&#39;m a frayed knot.&#34;</span>))
    <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/struct&#34;</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Struct</span>{<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;:&#34;</span>, <span style="color:#e6db74">&#34;Gophers!&#34;</span>})
    <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;localhost:4000&#34;</span>, <span style="color:#66d9ef">nil</span>)
}
</code></pre></div><h2 id="練習圖片">練習：圖片</h2>
<p>​    還記得之前編寫的圖片生成器嗎？現在來另外編寫一個，不過這次將會返回 <code>image.Image</code> 來代替 slice 的數據。</p>
<p>​    自定義的 <code>Image</code> 類型，要實現<a href="http://golang.org/pkg/image/#Image">必要的方法</a>，並且調用 <code>pic.ShowImage</code> 。</p>
<p>​    <code>Bounds</code> 應當返回一個 <code>image.Rectangle</code>，例如 <code>image.Rect(0, 0, w, h)</code> 。</p>
<p>​    <code>ColorModel</code> 應當返回 <code>image.RGBAModel</code> 。</p>
<p>​    <code>At</code> 應當返回一個顏色；在這個例子裡，在最後一個圖片生成器的值 <code>v</code> 匹配 <code>color.RGBA{v, v, 255, 255}</code> 。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;code.google.com/p/go-tour/pic&#34;</span>
    <span style="color:#e6db74">&#34;image&#34;</span>
    <span style="color:#e6db74">&#34;image/color&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Image</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">h</span> <span style="color:#66d9ef">int</span>
    <span style="color:#a6e22e">seed</span> <span style="color:#66d9ef">uint8</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">self</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Image</span>) <span style="color:#a6e22e">ColorModel</span>() <span style="color:#a6e22e">color</span>.<span style="color:#a6e22e">Model</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">color</span>.<span style="color:#a6e22e">RGBAModel</span>
}
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">self</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Image</span>) <span style="color:#a6e22e">Bounds</span>() <span style="color:#a6e22e">image</span>.<span style="color:#a6e22e">Rectangle</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">image</span>.<span style="color:#a6e22e">Rect</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">h</span>)
}
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">self</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Image</span>) <span style="color:#a6e22e">At</span>(<span style="color:#a6e22e">x</span>, <span style="color:#a6e22e">y</span> <span style="color:#66d9ef">int</span>) <span style="color:#a6e22e">color</span>.<span style="color:#a6e22e">Color</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">color</span>.<span style="color:#a6e22e">RGBA</span>{<span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">seed</span> <span style="color:#f92672">+</span> uint8(<span style="color:#a6e22e">x</span>), <span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">seed</span> <span style="color:#f92672">+</span> uint8(<span style="color:#a6e22e">y</span>), <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">255</span>}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Image</span>{<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">120</span>}
    <span style="color:#a6e22e">pic</span>.<span style="color:#a6e22e">ShowImage</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">m</span>)
}
</code></pre></div><hr>
<h2 id="練習rot13-讀取器">練習：Rot13 讀取器</h2>
<p>​    一般的模式是 <a href="http://golang.org/pkg/io/#Reader">io.Reader</a> 包裹另一個 <code>io.Reader</code> ，用某些途徑修改特定的流。</p>
<p>​    例如，<a href="http://golang.org/pkg/compress/gzip/#NewReader">gzip.NewReader</a> 函式輸入一個 <code>io.Reader</code> （gzip 的數據流）並且返回一個同樣實現了 <code>io.Reader</code> 的 <code>*gzip.Reader</code>（解壓縮後的數據流）。</p>
<p>​    實現一個實現了 <code>io.Reader</code> 的 <code>rot13Reader</code> ，用 <a href="http://en.wikipedia.org/wiki/ROT13">ROT13</a> 修改數據流中的所有的字母進行密文替換。</p>
<p>​    <code>rot13Reader</code> 已經提供。通過實現其 <code>Read</code> 方法使得它匹配 <code>io.Reader</code> 。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;io&#34;</span>
    <span style="color:#e6db74">&#34;os&#34;</span>
    <span style="color:#e6db74">&#34;strings&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">rot13Reader</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">r</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Reader</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">self</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">rot13Reader</span>) <span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">p</span> []<span style="color:#66d9ef">byte</span>) (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">error</span>) {
    <span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">p</span>)
    <span style="color:#a6e22e">leng</span> <span style="color:#f92672">:=</span> len(<span style="color:#a6e22e">p</span>)
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">leng</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
        <span style="color:#66d9ef">switch</span> {
        <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] &lt; <span style="color:#e6db74">&#39;n&#39;</span>:
            <span style="color:#66d9ef">fallthrough</span>
        <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] &lt; <span style="color:#e6db74">&#39;N&#39;</span>:
            <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">13</span>
        <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;n&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#39;z&#39;</span>:
            <span style="color:#66d9ef">fallthrough</span>
        <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;N&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#39;Z&#39;</span>:
            <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">13</span>
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">leng</span>, <span style="color:#66d9ef">nil</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">NewReader</span>(
        <span style="color:#e6db74">&#34;Lbh penpxrq gur pbqr!&#34;</span>)
    <span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">rot13Reader</span>{<span style="color:#a6e22e">s</span>}
    <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Copy</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stdout</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">r</span>)
}
</code></pre></div>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                
                <a href="https://bbyy.io/sc/tags/exercise/">Exercise</a>
                
                
                
                <a href="https://bbyy.io/sc/tags/golang/">Golang</a>
                
                
            </div>
        </div>
    

    
    <div class="languages">
        <i class="fa fa-language"></i>
        <div class="links">
            
                <a href="https://bbyy.io/code/a-tour-of-go-exercise-solutions/">tc</a>
            
        </div>
    </div>
    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hallucigenia" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

    </div>

    
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong></strong>
            <ul>
                
                <li>
                    <a href="https://bbyy.io/sc/code/getting-started-gdb/">Python标准库 —— pdb调试工具使用</a>
                </li>
                
                <li>
                    <a href="https://bbyy.io/sc/code/a-tour-of-go-exercise-solutions/">Golang 练习N则</a>
                </li>
                
                <li>
                    <a href="https://bbyy.io/sc/article/sqlalchemy-add-page/">为 SqlAlchemy 添加分页逻辑</a>
                </li>
                
                <li>
                    <a href="https://bbyy.io/sc/code/openpyxl_tutorial/">Openpyxl使用 —— Python操作Excel文件总结</a>
                </li>
                
                <li>
                    <a href="https://bbyy.io/sc/code/gunicorn-supervisor-deploy/">Gunicorn Supervisor Deploy</a>
                </li>
                
                <li>
                    <a href="https://bbyy.io/sc/article/uwsgi-gunicorn/">uWSGI和Gunicorn对比实践笔记</a>
                </li>
                
            </ul>
        </div>
        

        
        <div class="categories">
            <a href="/sc/categories/"><strong></strong></a>
            <ul>
                
                <li>
                    <a href="/sc/categories/code">Code
                        (6)</a>
                </li>
                
                <li>
                    <a href="/sc/categories/%E5%AD%9F%E5%AD%90">孟子
                        (1)</a>
                </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong></strong>

                
                <a href="https://twitter.com/_fancyan" target="_blank"><i class="fab fa-twitter"></i></a>
                
                <a href="https://www.instagram.com/monophoton" target="_blank"><i class="fab fa-instagram"></i></a>
                
                <a href="https://github.com/hallucigenia" target="_blank"><i class="fab fa-github"></i></a>
                
            </div>
            

            <div class="languages">
                <strong></strong>
                
                
                <a href="https://bbyy.io/">tc</a>
                
                
                
                <a href="https://bbyy.io/sc/" class="active">sc</a>
                
                
                
                <a href="https://bbyy.io/en/">en</a>
                
                
            </div>
            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://t.me/hallucigenia" target="_blank">
                &copy;
                
                2020
                
                by Fancy
            </a>
            
        </div>
        <div class="author">
            <a href="https://bbyy.io"
                target="_blank">Fancy&#39;s Blog</a>
        </div>
    </div>
</div>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-160694437-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    


    <script type="text/javascript" src="https://bbyy.io/theme.js"></script>

    
    
    

    
    <div id="activate-algolia-search" class="hidden">
  <input type="hidden" id="algolia-search-appId" value="8JWRQ9KNXC">
  <input type="hidden" id="algolia-search-apiKey" value="0f05c447096335c55a457fe4cfaae96a">
  <input type="hidden" id="algolia-search-indexName" value="grimalog">
  <input type="hidden" id="algolia-search-noSearchResults" value="">

  
</div>

    


</body>

</html>
